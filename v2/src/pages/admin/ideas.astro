---
export const prerender = false;

import Layout from '../../layouts/Layout.astro';

// Mock analytics data - would come from database in production
const analytics = {
  totalPosts: 127,
  totalReactions: 1543,
  avgEngagement: 12.2,
  topTags: [
    { tag: 'Federal Reserve', count: 23, trend: 'up' as const },
    { tag: 'Market Structure', count: 18, trend: 'stable' as const },
    { tag: 'AI', count: 15, trend: 'up' as const },
    { tag: 'Real Estate', count: 12, trend: 'down' as const },
    { tag: 'Economics', count: 11, trend: 'stable' as const }
  ],
  recentActivity: [
    { action: 'New post by Research Team', time: '2 minutes ago', type: 'post' },
    { action: '15 insights on Fed analysis post', time: '1 hour ago', type: 'reaction' },
    { action: 'New comment thread started', time: '3 hours ago', type: 'comment' },
    { action: 'Post tagged with "Volatility"', time: '5 hours ago', type: 'tag' },
  ]
};
---

<Layout title="Ideas Admin - Markets Feeds">
  <!-- Admin Header -->
  <header class="admin-header">
    <div class="container">
      <div class="header-content">
        <div class="header-left">
          <a href="/ideas" class="back-link">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
            </svg>
          </a>
          <div class="header-title">
            <h1 class="page-title">Ideas Administration</h1>
            <span class="page-subtitle">Manage team insights and engagement</span>
          </div>
        </div>
        <div class="header-actions">
          <button class="action-btn secondary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
            </svg>
            Export Data
          </button>
          <button class="action-btn primary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
            Featured Posts
          </button>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="admin-layout">
      <!-- Analytics Overview -->
      <section class="analytics-section">
        <h2 class="section-title">Analytics Overview</h2>
        
        <div class="metrics-grid">
          <div class="metric-card">
            <div class="metric-icon">üìù</div>
            <div class="metric-content">
              <div class="metric-value">{analytics.totalPosts}</div>
              <div class="metric-label">Total Posts</div>
              <div class="metric-change positive">+12% this week</div>
            </div>
          </div>
          
          <div class="metric-card">
            <div class="metric-icon">üí°</div>
            <div class="metric-content">
              <div class="metric-value">{analytics.totalReactions.toLocaleString()}</div>
              <div class="metric-label">Total Insights</div>
              <div class="metric-change positive">+8% this week</div>
            </div>
          </div>
          
          <div class="metric-card">
            <div class="metric-icon">üìä</div>
            <div class="metric-content">
              <div class="metric-value">{analytics.avgEngagement}</div>
              <div class="metric-label">Avg Engagement</div>
              <div class="metric-change negative">-2% this week</div>
            </div>
          </div>
          
          <div class="metric-card">
            <div class="metric-icon">üë•</div>
            <div class="metric-content">
              <div class="metric-value">8</div>
              <div class="metric-label">Active Contributors</div>
              <div class="metric-change stable">No change</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Two Column Layout -->
      <div class="admin-grid">
        <!-- Left Column -->
        <div class="admin-main">
          <!-- Top Tags -->
          <section class="admin-section">
            <div class="section-header">
              <h3 class="section-title">Popular Topics</h3>
              <button class="section-action">Manage Tags</button>
            </div>
            
            <div class="tags-list">
              {analytics.topTags.map(tag => (
                <div class="tag-item">
                  <div class="tag-info">
                    <span class="tag-name">{tag.tag}</span>
                    <span class="tag-count">{tag.count} posts</span>
                  </div>
                  <div class="tag-trend">
                    <span class={`trend-indicator ${tag.trend}`}>
                      {tag.trend === 'up' ? '‚Üó' : tag.trend === 'down' ? '‚Üò' : '‚Üí'}
                    </span>
                  </div>
                </div>
              ))}
            </div>
          </section>

          <!-- Content Moderation -->
          <section class="admin-section">
            <div class="section-header">
              <h3 class="section-title">Content Moderation</h3>
              <span class="status-indicator">All clear</span>
            </div>
            
            <div class="moderation-stats">
              <div class="mod-stat">
                <span class="mod-label">Pending Review</span>
                <span class="mod-value">0</span>
              </div>
              <div class="mod-stat">
                <span class="mod-label">Reported Posts</span>
                <span class="mod-value">0</span>
              </div>
              <div class="mod-stat">
                <span class="mod-label">Auto-flagged</span>
                <span class="mod-value">0</span>
              </div>
            </div>
          </section>

          <!-- Export & Settings -->
          <section class="admin-section">
            <div class="section-header">
              <h3 class="section-title">Data Management</h3>
            </div>
            
            <div class="management-actions">
              <a href="/admin/recategorization" class="management-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12,2A3,3 0 0,1 15,5V7A3,3 0 0,1 12,10A3,3 0 0,1 9,7V5A3,3 0 0,1 12,2M21,12A9,9 0 0,1 12,21A9,9 0 0,1 3,12A9,9 0 0,1 12,3A9,9 0 0,1 21,12M16,7.5A4,4 0 0,0 12,3.5A4,4 0 0,0 8,7.5V9.5A4,4 0 0,0 12,13.5A4,4 0 0,0 16,9.5V7.5Z"/>
                </svg>
                Recategorize Feeds
              </a>
              
              <button class="management-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                </svg>
                Export All Posts
              </button>
              
              <button class="management-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
                </svg>
                Bulk Actions
              </button>
              
              <button class="management-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                </svg>
                Settings
              </button>
            </div>
          </section>
        </div>

        <!-- Right Column - Activity Feed -->
        <div class="admin-sidebar">
          <section class="admin-section">
            <div class="section-header">
              <h3 class="section-title">Recent Activity</h3>
              <span class="live-indicator">üü¢ Live</span>
            </div>
            
            <div class="activity-feed">
              {analytics.recentActivity.map(activity => (
                <div class="activity-item">
                  <div class={`activity-icon ${activity.type}`}>
                    {activity.type === 'post' ? 'üìù' : 
                     activity.type === 'reaction' ? 'üí°' : 
                     activity.type === 'comment' ? 'üí¨' : 'üè∑Ô∏è'}
                  </div>
                  <div class="activity-content">
                    <div class="activity-text">{activity.action}</div>
                    <div class="activity-time">{activity.time}</div>
                  </div>
                </div>
              ))}
            </div>
            
            <button class="view-all-btn">View All Activity</button>
          </section>

          <!-- Quick Stats -->
          <section class="admin-section">
            <div class="section-header">
              <h3 class="section-title">Today's Stats</h3>
            </div>
            
            <div class="quick-stats">
              <div class="quick-stat">
                <span class="stat-label">New Posts</span>
                <span class="stat-value">5</span>
              </div>
              <div class="quick-stat">
                <span class="stat-label">Total Insights</span>
                <span class="stat-value">47</span>
              </div>
              <div class="quick-stat">
                <span class="stat-label">Comments</span>
                <span class="stat-value">12</span>
              </div>
              <div class="quick-stat">
                <span class="stat-label">Active Users</span>
                <span class="stat-value">8</span>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>
</Layout>

<style>
  /* Admin Header */
  .admin-header {
    background: rgba(250, 251, 252, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid #e8ebed;
    padding: 20px 0;
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header-left {
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .back-link {
    color: #6b7280;
    text-decoration: none;
    padding: 8px;
    border-radius: 6px;
    transition: all 0.15s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .back-link:hover {
    background: #f3f4f6;
    color: #2a2a2a;
  }

  .header-title {
    display: flex;
    flex-direction: column;
  }

  .page-title {
    font-size: 20px;
    font-weight: 600;
    color: #2a2a2a;
    margin: 0;
    line-height: 1.2;
  }

  .page-subtitle {
    font-size: 13px;
    color: #6b7280;
    margin-top: 2px;
  }

  .header-actions {
    display: flex;
    gap: 12px;
  }

  .action-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 16px;
    border: 1px solid #e8ebed;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.15s ease;
    text-decoration: none;
  }

  .action-btn.primary {
    background: #1e40af;
    color: white;
    border-color: #1e40af;
  }

  .action-btn.primary:hover {
    background: #1d4ed8;
    border-color: #1d4ed8;
  }

  .action-btn.secondary {
    background: white;
    color: #6b7280;
  }

  .action-btn.secondary:hover {
    background: #f8fafc;
    color: #2a2a2a;
    border-color: #d1d5db;
  }

  /* Admin Layout */
  .admin-layout {
    padding: 32px 0;
  }

  .analytics-section {
    margin-bottom: 40px;
  }

  .section-title {
    font-size: 18px;
    font-weight: 600;
    color: #2a2a2a;
    margin-bottom: 20px;
  }

  /* Metrics Grid */
  .metrics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 20px;
    margin-bottom: 40px;
  }

  .metric-card {
    background: white;
    border: 1px solid #e8ebed;
    border-radius: 12px;
    padding: 24px;
    display: flex;
    align-items: center;
    gap: 16px;
    transition: all 0.15s ease;
  }

  .metric-card:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.04);
    border-color: #d1d5db;
  }

  .metric-icon {
    font-size: 24px;
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8fafc;
    border-radius: 12px;
  }

  .metric-content {
    flex: 1;
  }

  .metric-value {
    font-size: 24px;
    font-weight: 700;
    color: #2a2a2a;
    line-height: 1.2;
  }

  .metric-label {
    font-size: 13px;
    color: #6b7280;
    font-weight: 500;
    margin-top: 2px;
  }

  .metric-change {
    font-size: 12px;
    font-weight: 500;
    margin-top: 4px;
  }

  .metric-change.positive {
    color: #059669;
  }

  .metric-change.negative {
    color: #dc2626;
  }

  .metric-change.stable {
    color: #6b7280;
  }

  /* Admin Grid */
  .admin-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 32px;
  }

  .admin-section {
    background: white;
    border: 1px solid #e8ebed;
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 24px;
  }

  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }

  .section-title {
    font-size: 16px;
    font-weight: 600;
    color: #2a2a2a;
    margin: 0;
  }

  .section-action {
    padding: 6px 12px;
    background: #f8fafc;
    border: 1px solid #e8ebed;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 500;
    color: #6b7280;
    cursor: pointer;
    transition: all 0.15s ease;
  }

  .section-action:hover {
    background: #f3f4f6;
    color: #2a2a2a;
    border-color: #d1d5db;
  }

  /* Tags List */
  .tags-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .tag-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px;
    background: #f8fafc;
    border-radius: 8px;
    border: 1px solid #e8ebed;
  }

  .tag-info {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .tag-name {
    font-size: 14px;
    font-weight: 500;
    color: #2a2a2a;
  }

  .tag-count {
    font-size: 12px;
    color: #6b7280;
  }

  .trend-indicator {
    font-size: 16px;
    font-weight: 600;
  }

  .trend-indicator.up {
    color: #059669;
  }

  .trend-indicator.down {
    color: #dc2626;
  }

  .trend-indicator.stable {
    color: #6b7280;
  }

  /* Moderation */
  .moderation-stats {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .mod-stat {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid #f1f3f4;
  }

  .mod-stat:last-child {
    border-bottom: none;
  }

  .mod-label {
    font-size: 14px;
    color: #6b7280;
  }

  .mod-value {
    font-size: 14px;
    font-weight: 600;
    color: #2a2a2a;
  }

  .status-indicator {
    padding: 4px 8px;
    background: #d1fae5;
    color: #059669;
    font-size: 11px;
    font-weight: 500;
    border-radius: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  /* Management Actions */
  .management-actions {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .management-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 16px;
    background: #f8fafc;
    border: 1px solid #e8ebed;
    border-radius: 8px;
    font-size: 14px;
    color: #6b7280;
    cursor: pointer;
    transition: all 0.15s ease;
    text-align: left;
  }

  .management-btn:hover {
    background: #f3f4f6;
    color: #2a2a2a;
    border-color: #d1d5db;
  }

  /* Activity Feed */
  .activity-feed {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 16px;
  }

  .activity-item {
    display: flex;
    gap: 12px;
    padding: 8px 0;
  }

  .activity-icon {
    font-size: 16px;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8fafc;
    border-radius: 8px;
    flex-shrink: 0;
  }

  .activity-content {
    flex: 1;
  }

  .activity-text {
    font-size: 13px;
    color: #2a2a2a;
    line-height: 1.4;
  }

  .activity-time {
    font-size: 11px;
    color: #9ca3af;
    margin-top: 2px;
  }

  .live-indicator {
    font-size: 11px;
    font-weight: 500;
    color: #059669;
  }

  .view-all-btn {
    width: 100%;
    padding: 8px 16px;
    background: #f8fafc;
    border: 1px solid #e8ebed;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 500;
    color: #6b7280;
    cursor: pointer;
    transition: all 0.15s ease;
  }

  .view-all-btn:hover {
    background: #f3f4f6;
    color: #2a2a2a;
    border-color: #d1d5db;
  }

  /* Quick Stats */
  .quick-stats {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .quick-stat {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid #f1f3f4;
  }

  .quick-stat:last-child {
    border-bottom: none;
  }

  .stat-label {
    font-size: 13px;
    color: #6b7280;
  }

  .stat-value {
    font-size: 13px;
    font-weight: 600;
    color: #2a2a2a;
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .admin-grid {
      grid-template-columns: 1fr;
      gap: 24px;
    }
  }

  @media (max-width: 768px) {
    .header-content {
      flex-direction: column;
      gap: 16px;
      align-items: stretch;
    }

    .header-left {
      justify-content: center;
    }

    .header-actions {
      justify-content: center;
    }

    .metrics-grid {
      grid-template-columns: 1fr;
    }

    .admin-layout {
      padding: 20px 0;
    }

    .admin-section {
      padding: 16px;
    }
  }
</style>