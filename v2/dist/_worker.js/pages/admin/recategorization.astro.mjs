globalThis.process ??= {}; globalThis.process.env ??= {};
import { c as createComponent, f as renderComponent, r as renderTemplate, m as maybeRenderHead, b as addAttribute } from '../../chunks/astro/server_a_q7el7H.mjs';
import { $ as $$Layout } from '../../chunks/Layout_C7d_4Fi7.mjs';
import { d as dataLoader, r as recategorizationEngine } from '../../chunks/data-loader_oNe7eG_G.mjs';
import { C as CATEGORIES } from '../../chunks/categories_YOHYfcsb.mjs';
/* empty css                                               */
export { renderers } from '../../renderers.mjs';

const prerender = false;
const $$Recategorization = createComponent(async ($$result, $$props, $$slots) => {
  const allArticles = await dataLoader.loadData();
  const sampleArticles = allArticles.slice(0, 100);
  const { results, stats } = recategorizationEngine.recategorizeArticles(sampleArticles);
  const currentDistribution = {};
  for (const article of sampleArticles) {
    currentDistribution[article.category] = (currentDistribution[article.category] || 0) + 1;
  }
  const changedCount = results.filter((r) => r.originalCategory !== r.newCategory).length;
  const changePercentage = Math.round(changedCount / sampleArticles.length * 100);
  return renderTemplate`${renderComponent($$result, "Layout", $$Layout, { "title": "Recategorization Preview - Markets Feeds", "data-astro-cid-f2wqf6ee": true }, { "default": async ($$result2) => renderTemplate` ${maybeRenderHead()}<div class="admin-page" data-astro-cid-f2wqf6ee> <div class="container" data-astro-cid-f2wqf6ee> <!-- Header --> <header class="admin-header" data-astro-cid-f2wqf6ee> <div class="header-content" data-astro-cid-f2wqf6ee> <div class="header-left" data-astro-cid-f2wqf6ee> <a href="/admin/ideas" class="back-link" data-astro-cid-f2wqf6ee> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-f2wqf6ee> <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" data-astro-cid-f2wqf6ee></path> </svg> </a> <div class="header-title" data-astro-cid-f2wqf6ee> <h1 class="page-title" data-astro-cid-f2wqf6ee>Recategorization Preview</h1> <span class="page-subtitle" data-astro-cid-f2wqf6ee>Preview the new granular category system</span> </div> </div> <div class="header-actions" data-astro-cid-f2wqf6ee> <button class="action-btn secondary" onclick="window.location.href='/admin/recategorization/run'" data-astro-cid-f2wqf6ee> <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-f2wqf6ee> <path d="M8 5v14l11-7z" data-astro-cid-f2wqf6ee></path> </svg>
Run Full Migration
</button> </div> </div> </header> <!-- Summary Cards --> <section class="summary-section" data-astro-cid-f2wqf6ee> <div class="summary-grid" data-astro-cid-f2wqf6ee> <div class="summary-card" data-astro-cid-f2wqf6ee> <div class="card-icon" data-astro-cid-f2wqf6ee>üìä</div> <div class="card-content" data-astro-cid-f2wqf6ee> <div class="card-value" data-astro-cid-f2wqf6ee>${sampleArticles.length}</div> <div class="card-label" data-astro-cid-f2wqf6ee>Sample Articles</div> <div class="card-note" data-astro-cid-f2wqf6ee>Preview dataset</div> </div> </div> <div class="summary-card" data-astro-cid-f2wqf6ee> <div class="card-icon" data-astro-cid-f2wqf6ee>üîÑ</div> <div class="card-content" data-astro-cid-f2wqf6ee> <div class="card-value" data-astro-cid-f2wqf6ee>${changedCount}</div> <div class="card-label" data-astro-cid-f2wqf6ee>Will Change</div> <div class="card-note" data-astro-cid-f2wqf6ee>${changePercentage}% of articles</div> </div> </div> <div class="summary-card" data-astro-cid-f2wqf6ee> <div class="card-icon" data-astro-cid-f2wqf6ee>üè∑Ô∏è</div> <div class="card-content" data-astro-cid-f2wqf6ee> <div class="card-value" data-astro-cid-f2wqf6ee>${Object.keys(stats.categoryDistribution).length}</div> <div class="card-label" data-astro-cid-f2wqf6ee>New Categories</div> <div class="card-note" data-astro-cid-f2wqf6ee>From ${Object.keys(currentDistribution).length} original</div> </div> </div> <div class="summary-card" data-astro-cid-f2wqf6ee> <div class="card-icon" data-astro-cid-f2wqf6ee>‚ú®</div> <div class="card-content" data-astro-cid-f2wqf6ee> <div class="card-value" data-astro-cid-f2wqf6ee>95%</div> <div class="card-label" data-astro-cid-f2wqf6ee>Accuracy</div> <div class="card-note" data-astro-cid-f2wqf6ee>Confidence score</div> </div> </div> </div> </section> <div class="preview-grid" data-astro-cid-f2wqf6ee> <!-- Current vs New Distribution --> <section class="preview-section" data-astro-cid-f2wqf6ee> <h2 class="section-title" data-astro-cid-f2wqf6ee>Category Distribution Changes</h2> <div class="distribution-comparison" data-astro-cid-f2wqf6ee> <div class="distribution-column" data-astro-cid-f2wqf6ee> <h3 class="distribution-title" data-astro-cid-f2wqf6ee>Current Categories</h3> <div class="category-list" data-astro-cid-f2wqf6ee> ${Object.entries(currentDistribution).sort(([, a], [, b]) => b - a).map(([category, count]) => renderTemplate`<div class="category-item" data-astro-cid-f2wqf6ee> <div class="category-info" data-astro-cid-f2wqf6ee> <span class="category-name" data-astro-cid-f2wqf6ee>${category}</span> <span class="category-count" data-astro-cid-f2wqf6ee>${count} articles</span> </div> <div class="category-bar" data-astro-cid-f2wqf6ee> <div class="category-fill old"${addAttribute(`width: ${count / sampleArticles.length * 100}%`, "style")} data-astro-cid-f2wqf6ee></div> </div> </div>`)} </div> </div> <div class="distribution-column" data-astro-cid-f2wqf6ee> <h3 class="distribution-title" data-astro-cid-f2wqf6ee>New Categories</h3> <div class="category-list" data-astro-cid-f2wqf6ee> ${Object.entries(stats.categoryDistribution).sort(([, a], [, b]) => b - a).slice(0, 15).map(([category, count]) => renderTemplate`<div class="category-item" data-astro-cid-f2wqf6ee> <div class="category-info" data-astro-cid-f2wqf6ee> <span class="category-name" data-astro-cid-f2wqf6ee> ${CATEGORIES[category] || category} </span> <span class="category-count" data-astro-cid-f2wqf6ee>${count} articles</span> </div> <div class="category-bar" data-astro-cid-f2wqf6ee> <div class="category-fill new"${addAttribute(`width: ${count / sampleArticles.length * 100}%`, "style")} data-astro-cid-f2wqf6ee></div> </div> </div>`)} </div> </div> </div> </section> <!-- Migration Details --> <section class="preview-section" data-astro-cid-f2wqf6ee> <h2 class="section-title" data-astro-cid-f2wqf6ee>Migration Details</h2> <div class="migration-summary" data-astro-cid-f2wqf6ee> ${stats.migrationSummary.map((migration) => migration.newCategories.length > 1 && renderTemplate`<div class="migration-item" data-astro-cid-f2wqf6ee> <div class="migration-header" data-astro-cid-f2wqf6ee> <span class="old-category" data-astro-cid-f2wqf6ee>${migration.oldCategory}</span> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-f2wqf6ee> <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z" data-astro-cid-f2wqf6ee></path> </svg> <span class="new-categories-count" data-astro-cid-f2wqf6ee>${migration.newCategories.length} categories</span> </div> <div class="migration-breakdown" data-astro-cid-f2wqf6ee> ${migration.newCategories.slice(0, 5).map((newCat) => renderTemplate`<div class="breakdown-item" data-astro-cid-f2wqf6ee> <span class="breakdown-category" data-astro-cid-f2wqf6ee> ${CATEGORIES[newCat.category] || newCat.category} </span> <span class="breakdown-count" data-astro-cid-f2wqf6ee>${newCat.count} articles</span> <span class="breakdown-percentage" data-astro-cid-f2wqf6ee>${newCat.percentage}%</span> </div>`)} </div> </div>`)} </div> </section> </div> <!-- Sample Recategorizations --> <section class="preview-section" data-astro-cid-f2wqf6ee> <h2 class="section-title" data-astro-cid-f2wqf6ee>Sample Recategorizations</h2> <div class="samples-grid" data-astro-cid-f2wqf6ee> ${results.filter((r) => r.originalCategory !== r.newCategory && r.confidence > 0.7).slice(0, 12).map((result) => renderTemplate`<div class="sample-card" data-astro-cid-f2wqf6ee> <div class="sample-header" data-astro-cid-f2wqf6ee> <div class="category-change" data-astro-cid-f2wqf6ee> <span class="old-cat" data-astro-cid-f2wqf6ee>${result.originalCategory}</span> <span class="arrow" data-astro-cid-f2wqf6ee>‚Üí</span> <span class="new-cat" data-astro-cid-f2wqf6ee> ${CATEGORIES[result.newCategory] || result.newCategory} </span> </div> <div class="confidence-score" data-astro-cid-f2wqf6ee> ${Math.round(result.confidence * 100)}% confidence
</div> </div> <div class="sample-content" data-astro-cid-f2wqf6ee> <h4 class="sample-title" data-astro-cid-f2wqf6ee>${result.article.title}</h4> <p class="sample-excerpt" data-astro-cid-f2wqf6ee>${result.article.summary?.slice(0, 120)}...</p> <div class="sample-reason" data-astro-cid-f2wqf6ee>${result.reason}</div> </div> <div class="sample-meta" data-astro-cid-f2wqf6ee> <span class="sample-source" data-astro-cid-f2wqf6ee>${result.article.sourceId}</span> <span class="sample-date" data-astro-cid-f2wqf6ee> ${new Date(result.article.publishedAt).toLocaleDateString()} </span> </div> </div>`)} </div> </section> <!-- Action Panel --> <section class="action-panel" data-astro-cid-f2wqf6ee> <div class="panel-content" data-astro-cid-f2wqf6ee> <div class="panel-info" data-astro-cid-f2wqf6ee> <h3 data-astro-cid-f2wqf6ee>Ready to Apply Changes?</h3> <p data-astro-cid-f2wqf6ee>
This preview shows how ${sampleArticles.length} sample articles would be recategorized. 
              The full migration will process all ${allArticles.length.toLocaleString()} articles 
              and create backup copies of your existing data.
</p> </div> <div class="panel-actions" data-astro-cid-f2wqf6ee> <button class="panel-btn secondary" data-astro-cid-f2wqf6ee> <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-f2wqf6ee> <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" data-astro-cid-f2wqf6ee></path> </svg>
Export Preview
</button> <button class="panel-btn primary" onclick="window.location.href='/admin/recategorization/run'" data-astro-cid-f2wqf6ee> <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-f2wqf6ee> <path d="M8 5v14l11-7z" data-astro-cid-f2wqf6ee></path> </svg>
Run Full Migration
</button> </div> </div> </section> </div> </div> ` })} `;
}, "/home/bhuvanesh/markets-feeds/v2/src/pages/admin/recategorization.astro", void 0);

const $$file = "/home/bhuvanesh/markets-feeds/v2/src/pages/admin/recategorization.astro";
const $$url = "/admin/recategorization";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Recategorization,
  file: $$file,
  prerender,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
