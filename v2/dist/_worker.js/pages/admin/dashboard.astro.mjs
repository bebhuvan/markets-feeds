globalThis.process ??= {}; globalThis.process.env ??= {};
import { c as createComponent, f as renderComponent, r as renderTemplate, m as maybeRenderHead, b as addAttribute } from '../../chunks/astro/server_a_q7el7H.mjs';
import { $ as $$Layout } from '../../chunks/Layout_C7d_4Fi7.mjs';
import { d as dataLoader } from '../../chunks/data-loader_oNe7eG_G.mjs';
import { C as CATEGORIES } from '../../chunks/categories_YOHYfcsb.mjs';
/* empty css                                        */
export { renderers } from '../../renderers.mjs';

const prerender = false;
const $$Dashboard = createComponent(async ($$result, $$props, $$slots) => {
  const allItems = await dataLoader.loadData();
  const categoryCounts = await dataLoader.getCategoryCounts();
  const sourceCounts = await dataLoader.getSourceCounts();
  const totalArticles = allItems.length;
  const last24Hours = allItems.filter((item) => {
    const itemDate = new Date(item.publishedAt);
    const cutoff = new Date(Date.now() - 24 * 60 * 60 * 1e3);
    return itemDate >= cutoff;
  }).length;
  const lastWeek = allItems.filter((item) => {
    const itemDate = new Date(item.publishedAt);
    const cutoff = new Date(Date.now() - 7 * 24 * 60 * 60 * 1e3);
    return itemDate >= cutoff;
  }).length;
  const lastUpdate = allItems.length > 0 ? new Date(Math.max(...allItems.map((item) => new Date(item.fetchedAt || item.publishedAt).getTime()))) : /* @__PURE__ */ new Date();
  const topSources = Object.entries(sourceCounts).sort(([, a], [, b]) => b - a).slice(0, 10).map(([sourceId, count]) => ({
    id: sourceId,
    name: sourceId.replace(/-/g, " ").replace(/\b\w/g, (l) => l.toUpperCase()),
    count
  }));
  const recentArticles = allItems.slice(0, 10);
  const categoryStats = Object.entries(categoryCounts).map(([key, count]) => ({
    key,
    name: CATEGORIES[key] || key,
    count,
    percentage: (count / totalArticles * 100).toFixed(1)
  })).sort((a, b) => b.count - a.count);
  const feedHealth = {
    activeFeeds: Object.keys(sourceCounts).length,
    avgArticlesPerFeed: Math.round(totalArticles / Math.max(Object.keys(sourceCounts).length, 1)),
    categoriesUsed: Object.keys(categoryCounts).length,
    totalCategories: Object.keys(CATEGORIES).length
  };
  const avgAge = allItems.length > 0 ? allItems.reduce((sum, item) => {
    const age = Date.now() - new Date(item.publishedAt).getTime();
    return sum + age / (1e3 * 60 * 60);
  }, 0) / allItems.length : 0;
  const freshnessScore = Math.max(0, Math.min(100, 100 - avgAge / 24 * 10));
  return renderTemplate`${renderComponent($$result, "Layout", $$Layout, { "title": "Feed Management Dashboard - Markets Feeds", "data-astro-cid-x6qnsptu": true }, { "default": async ($$result2) => renderTemplate` ${maybeRenderHead()}<div class="dashboard" data-astro-cid-x6qnsptu> <div class="container" data-astro-cid-x6qnsptu> <!-- Dashboard Header --> <header class="dashboard-header" data-astro-cid-x6qnsptu> <div class="header-content" data-astro-cid-x6qnsptu> <div class="header-left" data-astro-cid-x6qnsptu> <a href="/" class="back-link" data-astro-cid-x6qnsptu> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" data-astro-cid-x6qnsptu></path> </svg> </a> <div class="header-title" data-astro-cid-x6qnsptu> <h1 class="page-title" data-astro-cid-x6qnsptu>Feed Management Dashboard</h1> <span class="page-subtitle" data-astro-cid-x6qnsptu>Monitor and manage all feed sources</span> </div> </div> <div class="header-actions" data-astro-cid-x6qnsptu> <button class="action-btn primary" onclick="refreshFeeds()" data-astro-cid-x6qnsptu> <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" data-astro-cid-x6qnsptu></path> </svg>
Refresh Feeds
</button> <a href="/admin/cache-status" class="action-btn secondary" data-astro-cid-x6qnsptu> <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" data-astro-cid-x6qnsptu></path> </svg>
Cache Status
</a> </div> </div> </header> <!-- Key Metrics --> <section class="metrics-section" data-astro-cid-x6qnsptu> <div class="metrics-grid" data-astro-cid-x6qnsptu> <div class="metric-card primary" data-astro-cid-x6qnsptu> <div class="metric-icon" data-astro-cid-x6qnsptu>ðŸ“Š</div> <div class="metric-content" data-astro-cid-x6qnsptu> <div class="metric-value" data-astro-cid-x6qnsptu>${totalArticles.toLocaleString()}</div> <div class="metric-label" data-astro-cid-x6qnsptu>Total Articles</div> <div class="metric-change positive" data-astro-cid-x6qnsptu>+${last24Hours} today</div> </div> </div> <div class="metric-card" data-astro-cid-x6qnsptu> <div class="metric-icon" data-astro-cid-x6qnsptu>âš¡</div> <div class="metric-content" data-astro-cid-x6qnsptu> <div class="metric-value" data-astro-cid-x6qnsptu>${last24Hours}</div> <div class="metric-label" data-astro-cid-x6qnsptu>Last 24 Hours</div> <div class="metric-change" data-astro-cid-x6qnsptu>${lastWeek} this week</div> </div> </div> <div class="metric-card" data-astro-cid-x6qnsptu> <div class="metric-icon" data-astro-cid-x6qnsptu>ðŸ“¡</div> <div class="metric-content" data-astro-cid-x6qnsptu> <div class="metric-value" data-astro-cid-x6qnsptu>${feedHealth.activeFeeds}</div> <div class="metric-label" data-astro-cid-x6qnsptu>Active Feeds</div> <div class="metric-change" data-astro-cid-x6qnsptu>${feedHealth.avgArticlesPerFeed} avg/feed</div> </div> </div> <div class="metric-card" data-astro-cid-x6qnsptu> <div class="metric-icon" data-astro-cid-x6qnsptu>ðŸ”„</div> <div class="metric-content" data-astro-cid-x6qnsptu> <div class="metric-value" data-astro-cid-x6qnsptu>${Math.round(freshnessScore)}%</div> <div class="metric-label" data-astro-cid-x6qnsptu>Freshness Score</div> <div class="metric-change" data-astro-cid-x6qnsptu>${new Date(lastUpdate).toLocaleTimeString()}</div> </div> </div> </div> </section> <!-- Main Dashboard Grid --> <div class="dashboard-grid" data-astro-cid-x6qnsptu> <!-- Category Distribution --> <section class="dashboard-card" data-astro-cid-x6qnsptu> <div class="card-header" data-astro-cid-x6qnsptu> <h3 class="card-title" data-astro-cid-x6qnsptu>Category Distribution</h3> <div class="card-actions" data-astro-cid-x6qnsptu> <a href="/admin/strategic-categories" class="card-action" data-astro-cid-x6qnsptu> <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z" data-astro-cid-x6qnsptu></path> </svg> </a> </div> </div> <div class="category-stats" data-astro-cid-x6qnsptu> ${categoryStats.slice(0, 8).map((cat) => renderTemplate`<div class="category-stat" data-astro-cid-x6qnsptu> <div class="category-info" data-astro-cid-x6qnsptu> <span class="category-name" data-astro-cid-x6qnsptu>${cat.name}</span> <span class="category-count" data-astro-cid-x6qnsptu>${cat.count}</span> </div> <div class="category-bar" data-astro-cid-x6qnsptu> <div class="category-fill"${addAttribute(`width: ${cat.percentage}%`, "style")} data-astro-cid-x6qnsptu></div> </div> <span class="category-percentage" data-astro-cid-x6qnsptu>${cat.percentage}%</span> </div>`)} </div> </section> <!-- Top Sources --> <section class="dashboard-card" data-astro-cid-x6qnsptu> <div class="card-header" data-astro-cid-x6qnsptu> <h3 class="card-title" data-astro-cid-x6qnsptu>Top Sources</h3> <div class="card-actions" data-astro-cid-x6qnsptu> <button class="card-action" onclick="manageSources()" data-astro-cid-x6qnsptu> <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" data-astro-cid-x6qnsptu></path> </svg> </button> </div> </div> <div class="source-list" data-astro-cid-x6qnsptu> ${topSources.map((source) => renderTemplate`<div class="source-item" data-astro-cid-x6qnsptu> <div class="source-info" data-astro-cid-x6qnsptu> <div class="source-name" data-astro-cid-x6qnsptu>${source.name}</div> <div class="source-id" data-astro-cid-x6qnsptu>${source.id}</div> </div> <div class="source-count" data-astro-cid-x6qnsptu>${source.count}</div> </div>`)} </div> </section> <!-- Recent Articles --> <section class="dashboard-card full-width" data-astro-cid-x6qnsptu> <div class="card-header" data-astro-cid-x6qnsptu> <h3 class="card-title" data-astro-cid-x6qnsptu>Recent Articles</h3> <div class="card-actions" data-astro-cid-x6qnsptu> <a href="/" class="card-action" data-astro-cid-x6qnsptu> <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z" data-astro-cid-x6qnsptu></path> </svg> </a> </div> </div> <div class="recent-articles" data-astro-cid-x6qnsptu> ${recentArticles.map((article) => renderTemplate`<div class="article-item" data-astro-cid-x6qnsptu> <div class="article-content" data-astro-cid-x6qnsptu> <div class="article-title" data-astro-cid-x6qnsptu> <a${addAttribute(article.url, "href")} target="_blank" rel="noopener noreferrer" data-astro-cid-x6qnsptu> ${article.title} </a> </div> <div class="article-meta" data-astro-cid-x6qnsptu> <span class="article-source" data-astro-cid-x6qnsptu>${article.sourceName}</span> <span class="article-category" data-astro-cid-x6qnsptu>${CATEGORIES[article.category] || article.category}</span> <span class="article-time" data-astro-cid-x6qnsptu> ${new Date(article.publishedAt).toLocaleDateString("en-US", {
    month: "short",
    day: "numeric",
    hour: "2-digit",
    minute: "2-digit"
  })} </span> </div> </div> <div class="article-actions" data-astro-cid-x6qnsptu> <button class="article-action"${addAttribute(`togglePriority('${article.id}')`, "onclick")} data-astro-cid-x6qnsptu> <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" data-astro-cid-x6qnsptu></path> </svg> </button> <button class="article-action"${addAttribute(`hideArticle('${article.id}')`, "onclick")} data-astro-cid-x6qnsptu> <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z" data-astro-cid-x6qnsptu></path> </svg> </button> </div> </div>`)} </div> </section> <!-- Feed Health Status --> <section class="dashboard-card" data-astro-cid-x6qnsptu> <div class="card-header" data-astro-cid-x6qnsptu> <h3 class="card-title" data-astro-cid-x6qnsptu>Feed Health</h3> </div> <div class="health-metrics" data-astro-cid-x6qnsptu> <div class="health-item" data-astro-cid-x6qnsptu> <div class="health-label" data-astro-cid-x6qnsptu>Data Freshness</div> <div class="health-value" data-astro-cid-x6qnsptu> <div class="health-bar" data-astro-cid-x6qnsptu> <div class="health-fill"${addAttribute(`width: ${freshnessScore}%`, "style")} data-astro-cid-x6qnsptu></div> </div> <span data-astro-cid-x6qnsptu>${Math.round(freshnessScore)}%</span> </div> </div> <div class="health-item" data-astro-cid-x6qnsptu> <div class="health-label" data-astro-cid-x6qnsptu>Category Coverage</div> <div class="health-value" data-astro-cid-x6qnsptu> <div class="health-bar" data-astro-cid-x6qnsptu> <div class="health-fill"${addAttribute(`width: ${feedHealth.categoriesUsed / feedHealth.totalCategories * 100}%`, "style")} data-astro-cid-x6qnsptu></div> </div> <span data-astro-cid-x6qnsptu>${feedHealth.categoriesUsed}/${feedHealth.totalCategories}</span> </div> </div> <div class="health-item" data-astro-cid-x6qnsptu> <div class="health-label" data-astro-cid-x6qnsptu>Feed Diversity</div> <div class="health-value" data-astro-cid-x6qnsptu> <div class="health-bar" data-astro-cid-x6qnsptu> <div class="health-fill" style="width: 85%" data-astro-cid-x6qnsptu></div> </div> <span data-astro-cid-x6qnsptu>85%</span> </div> </div> </div> </section> <!-- Quick Actions --> <section class="dashboard-card" data-astro-cid-x6qnsptu> <div class="card-header" data-astro-cid-x6qnsptu> <h3 class="card-title" data-astro-cid-x6qnsptu>Quick Actions</h3> </div> <div class="quick-actions" data-astro-cid-x6qnsptu> <button class="quick-action" onclick="refreshFeeds()" data-astro-cid-x6qnsptu> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" data-astro-cid-x6qnsptu></path> </svg> <span data-astro-cid-x6qnsptu>Refresh All Feeds</span> </button> <button class="quick-action" onclick="exportData()" data-astro-cid-x6qnsptu> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" data-astro-cid-x6qnsptu></path> </svg> <span data-astro-cid-x6qnsptu>Export Data</span> </button> <a href="/admin/recategorization" class="quick-action" data-astro-cid-x6qnsptu> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" data-astro-cid-x6qnsptu></path> </svg> <span data-astro-cid-x6qnsptu>Manage Categories</span> </a> <button class="quick-action" onclick="clearCache()" data-astro-cid-x6qnsptu> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-x6qnsptu> <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" data-astro-cid-x6qnsptu></path> </svg> <span data-astro-cid-x6qnsptu>Clear Cache</span> </button> </div> </section> </div> </div> </div> ` })}  `;
}, "/home/bhuvanesh/markets-feeds/v2/src/pages/admin/dashboard.astro", void 0);

const $$file = "/home/bhuvanesh/markets-feeds/v2/src/pages/admin/dashboard.astro";
const $$url = "/admin/dashboard";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Dashboard,
  file: $$file,
  prerender,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
