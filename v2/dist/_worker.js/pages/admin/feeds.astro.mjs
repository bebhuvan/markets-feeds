globalThis.process ??= {}; globalThis.process.env ??= {};
import { c as createComponent, f as renderComponent, r as renderTemplate, m as maybeRenderHead, b as addAttribute } from '../../chunks/astro/server_a_q7el7H.mjs';
import { $ as $$Layout } from '../../chunks/Layout_C7d_4Fi7.mjs';
import { d as dataLoader } from '../../chunks/data-loader_C_xSJv18.mjs';
/* empty css                                    */
export { renderers } from '../../renderers.mjs';

const prerender = false;
const $$Feeds = createComponent(async ($$result, $$props, $$slots) => {
  const allItems = await dataLoader.loadData();
  const sourceCounts = await dataLoader.getSourceCounts();
  const feedSources = Object.entries(sourceCounts).map(([sourceId, count]) => {
    const sampleArticles = allItems.filter((item) => item.sourceId === sourceId).slice(0, 3);
    const latestArticle = sampleArticles[0];
    return {
      id: sourceId,
      name: latestArticle?.sourceName || sourceId.replace(/-/g, " ").replace(/\b\w/g, (l) => l.toUpperCase()),
      articleCount: count,
      lastUpdate: latestArticle?.fetchedAt || latestArticle?.publishedAt,
      status: count > 0 ? "active" : "inactive",
      categories: [...new Set(sampleArticles.map((a) => a.category))],
      sampleUrl: latestArticle?.url,
      avgPerDay: Math.round(count / 35)
      // Rough estimate based on ~35 days of data
    };
  }).sort((a, b) => b.articleCount - a.articleCount);
  const totalFeeds = feedSources.length;
  const activeFeeds = feedSources.filter((f) => f.status === "active").length;
  const totalArticles = allItems.length;
  return renderTemplate`${renderComponent($$result, "Layout", $$Layout, { "title": "Feed Management - Markets Feeds", "data-astro-cid-u4pddmps": true }, { "default": async ($$result2) => renderTemplate` ${maybeRenderHead()}<div class="admin-page" data-astro-cid-u4pddmps> <div class="container" data-astro-cid-u4pddmps> <!-- Header --> <header class="page-header" data-astro-cid-u4pddmps> <div class="header-content" data-astro-cid-u4pddmps> <div class="header-left" data-astro-cid-u4pddmps> <a href="/admin/dashboard" class="back-link" data-astro-cid-u4pddmps> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-u4pddmps> <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" data-astro-cid-u4pddmps></path> </svg> </a> <div class="header-title" data-astro-cid-u4pddmps> <h1 class="page-title" data-astro-cid-u4pddmps>Feed Management</h1> <span class="page-subtitle" data-astro-cid-u4pddmps>Manage all RSS feeds and data sources</span> </div> </div> <div class="header-actions" data-astro-cid-u4pddmps> <button class="action-btn primary" onclick="showAddFeedModal()" data-astro-cid-u4pddmps> <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-u4pddmps> <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" data-astro-cid-u4pddmps></path> </svg>
Add Feed
</button> <button class="action-btn secondary" onclick="bulkActions()" data-astro-cid-u4pddmps> <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-u4pddmps> <path d="M3 5h2V3c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v2h2c.6 0 1 .4 1 1s-.4 1-1 1h-1v13c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V7H2c-.6 0-1-.4-1-1s.4-1 1-1zm4-2v2h10V3H7zm2 7c0-.6.4-1 1-1s1 .4 1 1v6c0 .6-.4 1-1 1s-1-.4-1-1v-6zm4 0c0-.6.4-1 1-1s1 .4 1 1v6c0 .6-.4 1-1 1s-1-.4-1-1v-6z" data-astro-cid-u4pddmps></path> </svg>
Bulk Actions
</button> </div> </div> </header> <!-- Stats --> <section class="stats-section" data-astro-cid-u4pddmps> <div class="stats-grid" data-astro-cid-u4pddmps> <div class="stat-card" data-astro-cid-u4pddmps> <div class="stat-icon" data-astro-cid-u4pddmps>ðŸ“¡</div> <div class="stat-content" data-astro-cid-u4pddmps> <div class="stat-value" data-astro-cid-u4pddmps>${totalFeeds}</div> <div class="stat-label" data-astro-cid-u4pddmps>Total Feeds</div> </div> </div> <div class="stat-card" data-astro-cid-u4pddmps> <div class="stat-icon" data-astro-cid-u4pddmps>âœ…</div> <div class="stat-content" data-astro-cid-u4pddmps> <div class="stat-value" data-astro-cid-u4pddmps>${activeFeeds}</div> <div class="stat-label" data-astro-cid-u4pddmps>Active Feeds</div> </div> </div> <div class="stat-card" data-astro-cid-u4pddmps> <div class="stat-icon" data-astro-cid-u4pddmps>ðŸ“°</div> <div class="stat-content" data-astro-cid-u4pddmps> <div class="stat-value" data-astro-cid-u4pddmps>${totalArticles.toLocaleString()}</div> <div class="stat-label" data-astro-cid-u4pddmps>Total Articles</div> </div> </div> <div class="stat-card" data-astro-cid-u4pddmps> <div class="stat-icon" data-astro-cid-u4pddmps>ðŸ“ˆ</div> <div class="stat-content" data-astro-cid-u4pddmps> <div class="stat-value" data-astro-cid-u4pddmps>${Math.round(totalArticles / totalFeeds)}</div> <div class="stat-label" data-astro-cid-u4pddmps>Avg per Feed</div> </div> </div> </div> </section> <!-- Feed List --> <section class="feeds-section" data-astro-cid-u4pddmps> <div class="section-header" data-astro-cid-u4pddmps> <h2 class="section-title" data-astro-cid-u4pddmps>All Feeds (${totalFeeds})</h2> <div class="section-controls" data-astro-cid-u4pddmps> <div class="search-box" data-astro-cid-u4pddmps> <input type="text" id="feedSearch" placeholder="Search feeds..." onkeyup="filterFeeds()" data-astro-cid-u4pddmps> <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-u4pddmps> <path d="M15.5 14h-.79l-.28-.27c.98-1.14 1.57-2.62 1.57-4.23 0-3.59-2.91-6.5-6.5-6.5S2.5 5.91 2.5 9.5s2.91 6.5 6.5 6.5c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" data-astro-cid-u4pddmps></path> </svg> </div> <select id="statusFilter" onchange="filterFeeds()" data-astro-cid-u4pddmps> <option value="" data-astro-cid-u4pddmps>All Status</option> <option value="active" data-astro-cid-u4pddmps>Active</option> <option value="inactive" data-astro-cid-u4pddmps>Inactive</option> </select> <select id="sortBy" onchange="sortFeeds()" data-astro-cid-u4pddmps> <option value="articles" data-astro-cid-u4pddmps>Sort by Articles</option> <option value="name" data-astro-cid-u4pddmps>Sort by Name</option> <option value="updated" data-astro-cid-u4pddmps>Sort by Updated</option> </select> </div> </div> <div class="feeds-table-container" data-astro-cid-u4pddmps> <table class="feeds-table" id="feedsTable" data-astro-cid-u4pddmps> <thead data-astro-cid-u4pddmps> <tr data-astro-cid-u4pddmps> <th data-astro-cid-u4pddmps> <input type="checkbox" id="selectAll" onchange="toggleSelectAll()" data-astro-cid-u4pddmps> </th> <th data-astro-cid-u4pddmps>Feed Name</th> <th data-astro-cid-u4pddmps>Source ID</th> <th data-astro-cid-u4pddmps>Status</th> <th data-astro-cid-u4pddmps>Articles</th> <th data-astro-cid-u4pddmps>Categories</th> <th data-astro-cid-u4pddmps>Avg/Day</th> <th data-astro-cid-u4pddmps>Last Update</th> <th data-astro-cid-u4pddmps>Actions</th> </tr> </thead> <tbody data-astro-cid-u4pddmps> ${feedSources.map((feed) => renderTemplate`<tr class="feed-row"${addAttribute(feed.id, "data-feed-id")}${addAttribute(feed.status, "data-status")} data-astro-cid-u4pddmps> <td data-astro-cid-u4pddmps> <input type="checkbox" class="feed-checkbox"${addAttribute(feed.id, "value")} data-astro-cid-u4pddmps> </td> <td data-astro-cid-u4pddmps> <div class="feed-info" data-astro-cid-u4pddmps> <div class="feed-name" data-astro-cid-u4pddmps>${feed.name}</div> ${feed.sampleUrl && renderTemplate`<div class="feed-url" data-astro-cid-u4pddmps>${new URL(feed.sampleUrl).hostname}</div>`} </div> </td> <td data-astro-cid-u4pddmps> <code class="source-id" data-astro-cid-u4pddmps>${feed.id}</code> </td> <td data-astro-cid-u4pddmps> <span${addAttribute(`status-badge ${feed.status}`, "class")} data-astro-cid-u4pddmps> ${feed.status === "active" ? "\u2705 Active" : "\u26A0\uFE0F Inactive"} </span> </td> <td data-astro-cid-u4pddmps> <span class="article-count" data-astro-cid-u4pddmps>${feed.articleCount.toLocaleString()}</span> </td> <td data-astro-cid-u4pddmps> <div class="categories" data-astro-cid-u4pddmps> ${feed.categories.slice(0, 3).map((cat) => renderTemplate`<span class="category-tag" data-astro-cid-u4pddmps>${cat}</span>`)} ${feed.categories.length > 3 && renderTemplate`<span class="category-more" data-astro-cid-u4pddmps>+${feed.categories.length - 3}</span>`} </div> </td> <td data-astro-cid-u4pddmps> <span class="avg-count" data-astro-cid-u4pddmps>${feed.avgPerDay}</span> </td> <td data-astro-cid-u4pddmps> <span class="last-update" data-astro-cid-u4pddmps> ${feed.lastUpdate ? new Date(feed.lastUpdate).toLocaleDateString() : "Never"} </span> </td> <td data-astro-cid-u4pddmps> <div class="feed-actions" data-astro-cid-u4pddmps> <button class="action-btn-small edit"${addAttribute(`editFeed('${feed.id}')`, "onclick")} title="Edit" data-astro-cid-u4pddmps> <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-u4pddmps> <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" data-astro-cid-u4pddmps></path> </svg> </button> <button class="action-btn-small test"${addAttribute(`testFeed('${feed.id}')`, "onclick")} title="Test" data-astro-cid-u4pddmps> <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-u4pddmps> <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" data-astro-cid-u4pddmps></path> </svg> </button> <button class="action-btn-small delete"${addAttribute(`deleteFeed('${feed.id}')`, "onclick")} title="Delete" data-astro-cid-u4pddmps> <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" data-astro-cid-u4pddmps> <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" data-astro-cid-u4pddmps></path> </svg> </button> </div> </td> </tr>`)} </tbody> </table> </div> </section> </div> </div>  <div id="addFeedModal" class="modal" data-astro-cid-u4pddmps> <div class="modal-content" data-astro-cid-u4pddmps> <div class="modal-header" data-astro-cid-u4pddmps> <h3 data-astro-cid-u4pddmps>Add New Feed</h3> <button class="modal-close" onclick="closeModal('addFeedModal')" data-astro-cid-u4pddmps>&times;</button> </div> <form id="addFeedForm" onsubmit="submitAddFeed(event)" data-astro-cid-u4pddmps> <div class="form-group" data-astro-cid-u4pddmps> <label for="feedName" data-astro-cid-u4pddmps>Feed Name</label> <input type="text" id="feedName" name="name" required placeholder="e.g., Wall Street Journal" data-astro-cid-u4pddmps> </div> <div class="form-group" data-astro-cid-u4pddmps> <label for="feedUrl" data-astro-cid-u4pddmps>Feed URL</label> <input type="url" id="feedUrl" name="url" required placeholder="https://feeds.example.com/rss" data-astro-cid-u4pddmps> </div> <div class="form-group" data-astro-cid-u4pddmps> <label for="sourceId" data-astro-cid-u4pddmps>Source ID</label> <input type="text" id="sourceId" name="sourceId" required placeholder="wsj-markets" pattern="[a-z0-9-]+" data-astro-cid-u4pddmps> <small data-astro-cid-u4pddmps>Lowercase letters, numbers, and hyphens only</small> </div> <div class="form-group" data-astro-cid-u4pddmps> <label for="category" data-astro-cid-u4pddmps>Default Category</label> <select id="category" name="category" required data-astro-cid-u4pddmps> <option value="" data-astro-cid-u4pddmps>Select category...</option> <option value="markets" data-astro-cid-u4pddmps>Markets</option> <option value="macro" data-astro-cid-u4pddmps>Macro</option> <option value="policy" data-astro-cid-u4pddmps>Policy</option> <option value="technology" data-astro-cid-u4pddmps>Technology</option> <option value="crypto" data-astro-cid-u4pddmps>Crypto</option> <option value="central-banking" data-astro-cid-u4pddmps>Central Banking</option> <option value="regulation" data-astro-cid-u4pddmps>Regulation</option> <option value="research" data-astro-cid-u4pddmps>Research</option> <option value="blogs" data-astro-cid-u4pddmps>Blogs</option> <option value="news" data-astro-cid-u4pddmps>News</option> </select> </div> <div class="form-group" data-astro-cid-u4pddmps> <label for="fetchInterval" data-astro-cid-u4pddmps>Fetch Interval (minutes)</label> <select id="fetchInterval" name="fetchInterval" data-astro-cid-u4pddmps> <option value="15" data-astro-cid-u4pddmps>15 minutes</option> <option value="30" selected data-astro-cid-u4pddmps>30 minutes</option> <option value="60" data-astro-cid-u4pddmps>1 hour</option> <option value="120" data-astro-cid-u4pddmps>2 hours</option> <option value="240" data-astro-cid-u4pddmps>4 hours</option> </select> </div> <div class="form-group" data-astro-cid-u4pddmps> <label data-astro-cid-u4pddmps> <input type="checkbox" id="isActive" name="active" checked data-astro-cid-u4pddmps>
Active (start fetching immediately)
</label> </div> <div class="modal-actions" data-astro-cid-u4pddmps> <button type="button" class="btn secondary" onclick="closeModal('addFeedModal')" data-astro-cid-u4pddmps>Cancel</button> <button type="submit" class="btn primary" data-astro-cid-u4pddmps>Add Feed</button> </div> </form> </div> </div>  <div id="editFeedModal" class="modal" data-astro-cid-u4pddmps> <div class="modal-content" data-astro-cid-u4pddmps> <div class="modal-header" data-astro-cid-u4pddmps> <h3 data-astro-cid-u4pddmps>Edit Feed</h3> <button class="modal-close" onclick="closeModal('editFeedModal')" data-astro-cid-u4pddmps>&times;</button> </div> <form id="editFeedForm" onsubmit="submitEditFeed(event)" data-astro-cid-u4pddmps> <input type="hidden" id="editFeedId" name="feedId" data-astro-cid-u4pddmps> <div class="form-group" data-astro-cid-u4pddmps> <label for="editFeedName" data-astro-cid-u4pddmps>Feed Name</label> <input type="text" id="editFeedName" name="name" required data-astro-cid-u4pddmps> </div> <div class="form-group" data-astro-cid-u4pddmps> <label for="editFeedUrl" data-astro-cid-u4pddmps>Feed URL</label> <input type="url" id="editFeedUrl" name="url" required data-astro-cid-u4pddmps> </div> <div class="form-group" data-astro-cid-u4pddmps> <label for="editCategory" data-astro-cid-u4pddmps>Default Category</label> <select id="editCategory" name="category" required data-astro-cid-u4pddmps> <option value="markets" data-astro-cid-u4pddmps>Markets</option> <option value="macro" data-astro-cid-u4pddmps>Macro</option> <option value="policy" data-astro-cid-u4pddmps>Policy</option> <option value="technology" data-astro-cid-u4pddmps>Technology</option> <option value="crypto" data-astro-cid-u4pddmps>Crypto</option> <option value="central-banking" data-astro-cid-u4pddmps>Central Banking</option> <option value="regulation" data-astro-cid-u4pddmps>Regulation</option> <option value="research" data-astro-cid-u4pddmps>Research</option> <option value="blogs" data-astro-cid-u4pddmps>Blogs</option> <option value="news" data-astro-cid-u4pddmps>News</option> </select> </div> <div class="form-group" data-astro-cid-u4pddmps> <label for="editFetchInterval" data-astro-cid-u4pddmps>Fetch Interval (minutes)</label> <select id="editFetchInterval" name="fetchInterval" data-astro-cid-u4pddmps> <option value="15" data-astro-cid-u4pddmps>15 minutes</option> <option value="30" data-astro-cid-u4pddmps>30 minutes</option> <option value="60" data-astro-cid-u4pddmps>1 hour</option> <option value="120" data-astro-cid-u4pddmps>2 hours</option> <option value="240" data-astro-cid-u4pddmps>4 hours</option> </select> </div> <div class="form-group" data-astro-cid-u4pddmps> <label data-astro-cid-u4pddmps> <input type="checkbox" id="editIsActive" name="active" data-astro-cid-u4pddmps>
Active
</label> </div> <div class="modal-actions" data-astro-cid-u4pddmps> <button type="button" class="btn secondary" onclick="closeModal('editFeedModal')" data-astro-cid-u4pddmps>Cancel</button> <button type="submit" class="btn primary" data-astro-cid-u4pddmps>Update Feed</button> </div> </form> </div> </div> ` })}   `;
}, "/home/bhuvanesh/markets-feeds/v2/src/pages/admin/feeds.astro", void 0);

const $$file = "/home/bhuvanesh/markets-feeds/v2/src/pages/admin/feeds.astro";
const $$url = "/admin/feeds";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Feeds,
  file: $$file,
  prerender,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
